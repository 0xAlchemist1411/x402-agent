generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum AssetType {
  IMAGE
  VIDEO
  DOCUMENT
  AUDIO
  LINK
  OTHER
}

model User {
  id            String      @id @default(uuid())
  name          String?
  walletAddress String   @unique
  email         String?  @unique
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  // Relations
  assets Asset[]

  @@index([walletAddress])
  @@map("users")
}

model Asset {
  id           String     @id @default(uuid())
  filename     String
  originalName String?
  title        String?
  description  String?
  filePath     String
  base64Data   String?    @db.Text // Add this field
  assetType    AssetType?

  // Pricing
  price Decimal @default(0.01) @db.Decimal(10, 6) // USDC price with 6 decimals

  metadata Json?
  tags     String[] // Array of tags for searchability

  // Relations
  creatorId String
  creator   User     @relation(fields: [creatorId], references: [id])

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([assetType])
  @@index([price])
  @@index([createdAt])
  @@index([creatorId])
  @@map("assets")
}
